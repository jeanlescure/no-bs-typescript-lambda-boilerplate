<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 200 200" width="200"><defs/><rect fill="#3178c6" height="200" rx="19.531" width="200"/><rect fill="#3178c6" height="200" rx="19.531" width="200"/><path clip-rule="evenodd" d="M123.804 159.15v19.555c3.18 1.63 6.939 2.852 11.28 3.666 4.34.815 8.915 1.223 13.724 1.223 4.687 0 9.14-.448 13.358-1.345 4.218-.896 7.917-2.373 11.096-4.43 3.179-2.057 5.696-4.746 7.55-8.067 1.854-3.32 2.782-7.424 2.782-12.313 0-3.544-.53-6.65-1.59-9.32a21.78 21.78 0 00-4.585-7.118c-1.997-2.078-4.391-3.942-7.183-5.592-2.792-1.65-5.94-3.208-9.445-4.675a118.96 118.96 0 01-6.909-3.086c-2.037-.998-3.77-2.016-5.196-3.055-1.427-1.04-2.527-2.14-3.301-3.3-.774-1.161-1.162-2.475-1.162-3.942 0-1.344.347-2.556 1.04-3.636.692-1.08 1.67-2.006 2.934-2.78 1.264-.774 2.812-1.375 4.646-1.803 1.834-.428 3.872-.641 6.114-.641 1.63 0 3.352.122 5.165.366 1.814.245 3.638.622 5.472 1.13a38.092 38.092 0 015.35 1.926 29.483 29.483 0 014.798 2.689V96.33c-2.975-1.14-6.225-1.986-9.75-2.536-3.526-.55-7.571-.825-12.136-.825-4.646 0-9.048.499-13.205 1.497-4.157.998-7.815 2.556-10.974 4.675-3.158 2.118-5.654 4.817-7.488 8.097-1.834 3.28-2.752 7.2-2.752 11.763 0 5.826 1.682 10.796 5.044 14.911 3.362 4.115 8.467 7.598 15.314 10.45 2.69 1.1 5.197 2.179 7.52 3.238 2.323 1.06 4.33 2.16 6.021 3.3 1.692 1.141 3.026 2.384 4.005 3.728.978 1.344 1.467 2.872 1.467 4.583a7.012 7.012 0 01-.917 3.514c-.611 1.08-1.539 2.016-2.782 2.81-1.243.795-2.791 1.417-4.646 1.865-1.854.448-4.024.672-6.51.672-4.24 0-8.437-.743-12.594-2.23s-8.009-3.718-11.555-6.692zM90.93 110.97h25.086V94.922H46.094v16.048h24.963v71.452H90.93z" fill="#fff" fill-rule="evenodd"/></svg>
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 130 200" width="130"><defs/><path fill="#88b04b" fill-rule="evenodd" d="M50 55h30v90H50z"/><path fill="#88b04b" fill-rule="evenodd" d="M110 85v30H20V85z"/></svg>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 200 200" width="200"><defs/><defs><linearGradient x1="0" y1="1" x2="1" y2="0" id="a"><stop stop-color="#C8511B" offset="0%"/><stop stop-color="#F90" offset="100%"/></linearGradient><linearGradient xlink:href="#a" id="c" x1="0" y1="24" x2="24" y2="0" gradientUnits="userSpaceOnUse"/><linearGradient xlink:href="#a" id="b" x1="0" y1="24" x2="24" y2="0" gradientUnits="userSpaceOnUse"/></defs><g fill="none" fill-rule="evenodd"><path fill="url(#c)" d="M0 0h24v24H0z" transform="scale(8.33333)"/><path d="M69.623 158.333H44.448l29.525-59.95L86.578 123.6zm8.185-71.375c-.722-1.441-2.227-2.35-3.87-2.35h-.016c-1.643 0-3.147.925-3.86 2.367l-36.31 73.733a4.066 4.066 0 00.241 4.017 4.337 4.337 0 003.637 1.942h34.71c1.668 0 3.18-.925 3.894-2.384l19.002-38.925a4.102 4.102 0 00-.018-3.6zm80.26 71.375h-26.412L84.79 60.742c-.705-1.467-2.227-2.409-3.895-2.409H63.467l.017-16.666h34.752l46.652 97.583c.705 1.475 2.236 2.417 3.904 2.417h9.277zm4.3-25h-10.834L104.891 35.75c-.705-1.475-2.235-2.417-3.912-2.417H59.193c-2.373 0-4.298 1.867-4.298 4.167l-.026 25c0 1.1.455 2.158 1.264 2.95a4.365 4.365 0 003.035 1.217h18.984l46.867 97.591c.705 1.467 2.226 2.409 3.894 2.409h33.455c2.373 0 4.299-1.867 4.299-4.167v-25c0-2.3-1.926-4.167-4.3-4.167z" fill="#fff"/></g></svg>

# No BS Typescript Lambda Boilerplate

This boilerplate focuses on keeping configuration to a minimum yet supporting all latest Typescript
features for making it as easy and worry-free as possible to get started building a performance
optimized [AWS Lambda](https://aws.amazon.com/lambda/) Function.

This project is open to updates by its users, I ensure that PRs are relevant to the community.
In other words, if you find a bug or want a new feature, please help us by becoming one of the
[contributors](#contributors-) ✌️ ! See the [contributing section](#contributing).

:rotating_light: **Before continuing:**

- If you're creating an API using Express.js consider looking at my [No BS Typescript Server Boilerplate]()
- If you're creating a Javascript/Typescript module consider looking at my [No BS Typescript Boilerplate]()
- If you're creating a React.js app consider looking at my [No BS React Boilerplate]()

## Like this project? :heart:

Please consider:

- [Buying me a coffee](https://www.buymeacoffee.com/jeanlescure) :coffee:
- Supporting me on [Patreon](https://www.patreon.com/jeanlescure) :trophy:
- Starring this repo on [Github](https://github.com/jeanlescure/string-crypto) :star2:

## How to get started using this boilerplate

The logic of this repo is structured in such a way that all you need to worry about is placing your
code in the `src` directory (using `src/index.ts` as entry point).

## Development and build scripts

I chose Rollup to handle the transpiling, compression, and any other transformations needed to get
your Typescript code running as quickly and performant as possible.

**Development**

```
yarn dev
```

**NOTE:** This command depends on you having Docker installed in your development environment.

When run, this script will build your lambda and run a docker container with the image [lambci/lambda](https://hub.docker.com/r/lambci/lambda)
which is a sandboxed local environment that replicates the live AWS Lambda environment almost identically.

It also uses `nodemon` to rebuild and restart the docker container automagically whenever you
edit your typescript code, a.k.a. hot reload :fire:

Once running you can test your lambda by invoking it using `aws-cli`:

```
aws lambda invoke \
  --endpoint http://localhost:9001 \
  --no-sign-request \
  --function-name myfunction \
  --payload '{}' \
  output.json
```

**IMPORTANT:** If you are using AWS CLI v2 you must add the `--cli-binary-format raw-in-base64-out`
argument and value, as such:

```
aws lambda invoke \
  --endpoint http://localhost:9001 \
  --no-sign-request \
  --cli-binary-format raw-in-base64-out \
  --function-name myfunction \
  --payload '{}' \
  output.json
```

I have also provided a mock payload (`mock-payload.json`) that mimics an event sent by API Gateway,
which you can use by replacing the value of the `--payload` argument with a `file://` definition:

```
aws lambda invoke \
  --endpoint http://localhost:9001 \
  --no-sign-request \
  --cli-binary-format raw-in-base64-out \
  --function-name myfunction \
  --payload file://mock-payload.json \
  output.json
```

Finally, you can also test your function using an HTTP request with Postman, Insomnia, or even Curl, like so:

```
curl -d '{}' http://localhost:9001/2015-03-31/functions/myfunction/invocations
```

**Build**

```
yarn build
```

This command will build the `dist/index.js` bundle of your code (uglified and tree-shaken so it
loads/runs faster), it installs the node modules specified under the `"dependencies"` section
in the `package.json` (no `"devDependencies"`), and finally packages it all into a `function.zip`
file that you can upload to your aws account using the following commands:

```sh
# Create function
LAMBDA_NAME=myNoBSLambda

LAMBDA_ROLE_ARN=$(aws iam create-role \
  --role-name $LAMBDA_NAME \
  --assume-role-policy-document '{"Version": "2012-10-17","Statement": [{ "Effect": "Allow", "Principal": {"Service": "lambda.amazonaws.com"}, "Action": "sts:AssumeRole"}]}' \
  --query "Role.Arn" --output=text) \
&& sleep 15 \
&& aws iam attach-role-policy \
  --role-name $LAMBDA_NAME \
  --policy-arn arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole \
&& sleep 15 \
&& aws lambda create-function \
  --function-name $LAMBDA_NAME \
  --handler index.handler \
  --runtime nodejs12.x \
  --role $LAMBDA_ROLE_ARN \
  --zip-file fileb://dist/function.zip

# Update function
aws lambda update-function-code --function-name $LAMBDA_NAME --zip-file fileb://dist/function.zip
```

## Contributing

Yes, thank you! This plugin is community-driven, most of its features are from different authors.
Please update the docs and tests and add your name to the `package.json` file.

## Contributors ✨

Thanks goes to these wonderful people ([emoji key](https://allcontributors.org/docs/en/emoji-key)):
